<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>RISEOffline</title>
  <link rel="icon" href="https://fonts.gstatic.com/s/e/notoemoji/latest/1f305/512.gif" type="image/gif">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="toc">
    <h3>Content</h3>
    <hr>
    <ul>
      <li><a href="#abstract">Abstract</a></li>
      <li><a href="#approach">Approach</a></li>
      <li><a href="#ood-recovery">OOD Recovery</a></li>
      <li><a href="#suboptimal-demos">Suboptimal Demos</a></li>
      <li><a href="#multitask">Multi-Task Learning</a></li>
      <li><a href="#generalization">Generalization</a></li>
      <li><a href="#acknowledgements">Acknowledgements</a></li>
    </ul>
  </div>

  <div class="main-content">
    <div class="hero-text">RISE
    <img src="https://fonts.gstatic.com/s/e/notoemoji/latest/1f305/512.gif" alt="ðŸŒ…" style="display:inline-block; width:64px; height:64px; box-shadow:none; border:none; background:none; vertical-align:middle;">
    </div>
    <div class="sub-hero-text">Using Non-Expert Data to Robustify Imitation
Learning via Offline Reinforcement Learning</div>

    <!-- Add Authors -->
    <div class="authors">
      <a href="https://kevinhuang8.github.io/" target="_blank">Kevin Huang*</a>, <a href="https://rosari.ooo/" target="_blank">Rosario Scalise*</a>,
      Cleah Winston,
      Yunchu Zhang,
      Rohan Baijal, 
      Ayush Agrawal,
      Markus Grotz,
      Bryon Boots,
      Abhishek Gupta
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(*:equal contribution)
      <span class="affiliation">University of Washington
      <img src="https://upload.wikimedia.org/wikipedia/commons/1/17/Washington_Huskies_logo.svg" 
          alt="UW Logo" 
          style="height:1.6em; width:auto; aspect-ratio:auto; box-shadow:none; border:none; background:none; vertical-align:middle; margin-left:4px; border-radius:0;">
      </span>
      Benjamin Burchfiel,
      Hongkai Dai,
      Masha Itkina,
      Paarth Shah
      <span class="affiliation">Toyota Research Institute
      <img src="https://upload.wikimedia.org/wikipedia/commons/d/d5/Toyota_Research_Institute_Logo_Square.png"
           alt="Toyota Logo"
           style="height:2.5em; width:auto; aspect-ratio:auto; box-shadow:none; border:none; background:none; vertical-align:middle; margin-left:4px;">
      </span>
    </div>
    <!-- End Authors -->

    <video id="teaser-video" src="./figs/teaser.mp4" width="80%" height="auto" controls muted playsinline autoplay></video>
    <!-- Caption for Figure 1 (Teaser Video) -->
    <p class="figure-caption">
        <span style="font-variant: small-caps;">RISE</span>: Robust Imitation by Stiching from Experts demonstrates the following benefits.
    </p>

    <!-- Add Quick Links Here -->
    <div class="quick-links">
      <a href="./todo.pdf" target="_blank">[pdf]</a>
      <a href="https://github.com/UWRobotlearning" target="_blank">[arxiv]</a>
      <a href="https://github.com/UWRobotlearning">[code(soon)]</a> 
    </div>
    
    <div class="tagline" id="abstract">Abstract.</div>

    <div class="section">
        Imitation learning has proven highly effective for training robots to
        perform complex tasks from expert human demonstrations. However, it remains
        limited by reliance on high-quality, task-specific data, restricting adaptability to
        the diverse range of real-world object configurations and scenarios. In contrast,
        non-expert dataâ€”such as play data, suboptimal demonstrations, or partial task
        completionsâ€”can offer broader coverage and lower collection costs, but conven-
        tional imitation learning approaches fail to utilize this data effectively. To address
        these challenges, we show that offline reinforcement learning can be used as a
        tool to harness non-expert data to enhance the performance of imitation learning
        policies. We show that while standard offline RL approaches can be ineffective
        at actually leveraging non-expert data under sparse coverage, simple algorithmic
        modifications can allow the utilization of this data without significant additional
        assumptions. Our approach shows that broadening the support of the policy dis-
        tribution in offline RL can allow offline RL augmented imitation algorithms to
        solve tasks robustly, under sparse coverage. In manipulation tasks, these innova-
        tions significantly increase the range of states where learned policies are success-
        ful when non-expert data is incorporated. Moreover, we show that these methods
        are able to leverage all collected data, including partial or suboptimal demonstra-
        tions, to bolster task-directed policy performance, underscoring the importance of
        methods for using non-expert data for scalable and robust robot learning.
        We introduce <b>R</b>obust <b>I</b>mitation Learning by <b>S</b>titching from <b>E</b>xperts,
        or <span style="font-variant: small-caps;">RISE</span> ðŸŒ…. 
    </div> 

    <!-- =============================== APPROACH ==================================== -->
    <div class="tagline" id="approach">Approach: Robust Imitation Learning via Offline RL.</div>
    
    <div class="section">
      <p>
        <!-- TODO -->
      </p>
    </div>

    <!-- Paper Abstract Figure -->
    <a id="figure-1-img" href="figs/TeaserFig.jpeg" download="TeaserFig.jpeg">
      <img src="figs/TeaserFig.jpeg" alt="RISE Approach Overview">
    </a>
    <p class="figure-caption">
      <b>Figure 1:</b> Overview of RISE approach showing how non-expert data is leveraged to robustify imitation learning.
    </p>

    <!-- =============================== OOD RECOVERY ==================================== -->
    <div class="tagline" id="ood-recovery">RISE Enables OOD Recovery.</div>
    
    <div class="section">
      <p>
        RISE stitches together non-expert data trajectories, such as SE2 planar pushing data, with expert data to recover from OOD states.
      </p>
    </div>

    <!-- Condensed OOD Recovery Layout -->
    <div class="condensed-recovery-layout">
      <!-- Top row: First two examples side by side -->
      <div class="recovery-row">
        <div class="recovery-item">
          <p class="recovery-description">By utilizing play data, RISE is able to recover from <b>OOD states</b>.</p>
          <div class="video-comparison-container">
            <div class="video-item">
              <!-- TODO: Replace with FAILING BC Lampshade -->
              <video src="./lampshade/Lampshade_Expert_DATA.mp4" autoplay muted playsinline loop></video>
              <p class="video-caption"><b>BC Policy:</b> BC fails to recover from initial states that are OOD.</p>
            </div>
            <div class="video-item">
              <video src="./lampshade/LampshadeRecovery.mp4" autoplay muted playsinline loop></video>
              <p class="video-caption"><b>RISE:</b> By leveraging non-expert data, RISE is able to recover from OOD states.</p>
            </div>
          </div>
        </div>
        
        <div class="recovery-item">
          <p class="recovery-description">RISE enables recovery from cases where robot <b>misses the target</b> upon first attempt.</p>
          <div class="video-comparison-container">
            <div class="video-item">
              <!-- TODO: Replace with FAILING BC Tipping -->
              <video src="./tipping/Tipping_Single_Disturbance_BCU.mp4" autoplay muted playsinline loop></video>
              <p class="video-caption"><b>BC Policy:</b> BC fails to recover from initial states that are OOD.</p>
            </div>
            <div class="video-item">
              <video src="./tipping/Tipping_Recover_From_Failure.mp4" autoplay muted playsinline loop></video>
              <p class="video-caption"><b>RISE:</b> RISE is able to recover from robot mistakes.</p>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Bottom row: Third example centered -->
      <div class="recovery-row">
        <div class="recovery-item centered">
          <p class="recovery-description">RISE enables <b>continual recovery</b> in cases where robot is subject to multiple physical perturbations.</p>
          <div class="video-comparison-container">
            <div class="video-item">
              <!-- TODO: Replace with FAILING BC Tipping -->
              <video src="./tipping/Tipping_Single_Disturbance_BCU.mp4" autoplay muted playsinline loop></video>
              <p class="video-caption"><b>BC Policy:</b> BC fails to stitch together non-expert data with expert data.</p>
            </div>
            <div class="video-item">
              <video src="./tipping/Tipping_Two_Disturbance.mp4" autoplay muted playsinline loop></video>
              <p class="video-caption"><b>RISE:</b> RISE is able to continually recover from multiple disturbances.</p>
            </div>
          </div>
        </div>
      </div>
    </div>



    <!-- =============================== SUBOPTIMAL DEMOS ==================================== -->
    <div class="tagline" id="suboptimal-demos">RISE Leverages Suboptimal Demonstrations.</div>
    
    <div class="section">
      <p>
        Unlike most imitation learning methods, RISE is robust to suboptimal demonstrations and is able to stitch together useful segments of suboptimal demonstrations to robustify the expert.
      </p>
    </div>
    <i>change to one leg videos</i>
    <!-- Video Gallery Section - One Leg -->
    <div class="side-by-side-videos">
      <div class="video-comparison-container">
        <div class="video-item">
          <!-- TODO: Replace with FAILING BC One Leg -->
          <video src="./lampshade/Lampshade_Expert_DATA.mp4" autoplay muted playsinline loop></video>
          <p class="video-caption"><b>BC Policy:</b> BC learns to mimic suboptimal demonstrations, hence degrading task completion.</p>
        </div>
        <!-- TODO: Replace with RISE One Leg -->
        <div class="video-item">
          <video src="./lampshade/LampshadeRecovery.mp4" autoplay muted playsinline loop></video>
          <p class="video-caption"><b>RISE:</b> RISE is able to stitch together useful segments of suboptimal demonstrations to robustify the expert.</p>
        </div>
      </div>
    </div>

    <!-- =============================== Deformable Task ==================================== -->
    <!-- TODO: Change title -->
    <div class="tagline" id="suboptimal-demos">RISE Extends to Deformable Object Tasks.</div>
    
    <div class="section">
      <p>
        TODO 
      </p>
    </div>
    <!-- Video Gallery Section - Cloth -->
    <div class="side-by-side-videos">
      <div class="video-comparison-container">
        <div class="video-item">
          <!-- TODO: Replace with FAILING BC Cloth -->
          <video src="./cloth/Cloth_Fold.mp4" autoplay muted playsinline loop></video>
          <p class="video-caption"><b>BC Policy:</b> BC fails to stack the cloth and fold more than one cloth.</p>
        </div>
        <!-- TODO: Replace with RISE Cloth -->
        <div class="video-item">
          <video src="./cloth/Cloth_Stack.mp4" autoplay muted playsinline loop></video>
          <p class="video-caption"><b>RISE:</b> RISE successfully folds and stacks the cloths continually.</p>
        </div>
      </div>
    </div>


    <!-- =============================== MULTI-TASK LEARNING ==================================== -->
     <!-- TODO: Change title -->
    <div class="tagline" id="multitask">RISE Reduces the Cost of Learning New Tasks.</div>
    
    <div class="section">
      <p>
        By utilizing cheaper data that can be shared across tasks, RISE amoritzes the cost of collecting new data needed to learn new tasks.
      </p>
    </div>

    <!-- Video Gallery Section - Multi-Task -->
     <!-- TODO: Maybe not necessary? but could add sim videos or a better depiction of this -->
    <div class="side-by-side-videos">
      <div class="video-comparison-container">
        <div class="video-item">
          <!-- TODO: Replace with FAILING BC Sim -->
          <video src="./lampshade/Lampshade_Expert_DATA.mp4" autoplay muted playsinline loop></video>
          <p class="video-caption"><b>BC Policy:</b> BC learns to mimic suboptimal demonstrations, hence degrading task completion.</p>
        </div>
        <!-- TODO: Replace with RISE Sim -->
        <div class="video-item">
          <video src="./lampshade/LampshadeRecovery.mp4" autoplay muted playsinline loop></video>
          <p class="video-caption"><b>RISE:</b> RISE is able to stitch together useful segments of suboptimal demonstrations to robustify the expert.</p>
        </div>
      </div>

    </div>




<!-- remove if we keep above -->
  <!-- VIDEO GALLERIES -->

  <!-- Video Gallery Section - TIPPING VIDEOS -->
  <div class="video-gallery-section" id="tippingGallerySection">
    <div class="video-gallery-container">
      <div class="video-gallery" id="videoGalleryTipping">
        <!-- Videos remain here - ADD autoplay -->
        <video class="gallery-video" src="./tipping/Tipping_DATA.mp4" autoplay muted playsinline loop></video>
        <video class="gallery-video" src="./tipping/Tipping_Recover_From_Failure.mp4" autoplay muted playsinline loop></video>
        <video class="gallery-video" src="./tipping/Tipping_Single_Disturbance_BCU.mp4" autoplay muted playsinline loop></video>
        <video class="gallery-video" src="./tipping/Tipping_Single_Disturbance.mp4" autoplay muted playsinline loop></video>
        <!--- Insert more videos here!!!!-->
        <!-- Add more videos as needed, ensuring they have autoplay muted loop -->
      </div>
    </div>
    <!-- Container for the caption AND buttons -->
    <div class="gallery-caption-container">
        <!-- Move button controls INSIDE caption container -->
        <div class="gallery-nav-controls">
            <button class="gallery-nav left" id="scrollLeftBtnTraversing">&lt;</button>
            <button class="gallery-nav right" id="scrollRightBtnTraversing">&gt;</button>
        </div>
        <!-- Caption text -->
        <p class="figure-caption gallery-caption">
            <b>Tipping:</b> Yada yada.
        </p>
    </div>
  </div>

<!-- Video Gallery Section - Cloth VIDEOS -->
  <div class="video-gallery-section" id="ClothGallerySection">
    <div class="video-gallery-container">
      <div class="video-gallery" id="videoGalleryCloth">
        <!-- Videos remain here - ADD autoplay -->
        <video class="gallery-video" src="./cloth/Cloth_Fold_DATA.mp4" autoplay muted playsinline loop></video>
        <video class="gallery-video" src="./cloth/Cloth_Fold.mp4" autoplay muted playsinline loop></video>
        <video class="gallery-video" src="./cloth/Cloth_Stack_DATA.mp4" autoplay muted playsinline loop></video>
        <video class="gallery-video" src="./cloth/Cloth_Stack.mp4" autoplay muted playsinline loop></video>
        <!--- Insert more videos here!!!!-->
        <!-- Add more videos as needed, ensuring they have autoplay muted loop -->
      </div>
    </div>
    <!-- Container for the caption AND buttons -->
    <!-- <div class="gallery-caption-container"> -->
        <!-- Move button controls INSIDE caption container -->
        <!-- <div class="gallery-nav-controls">
            <button class="gallery-nav left" id="scrollLeftBtnTraversing">&lt;</button>
            <button class="gallery-nav right" id="scrollRightBtnTraversing">&gt;</button>
        </div>
        <p class="figure-caption gallery-caption">
            <b>Cloth:</b> Yada yada.
        </p>
    </div>
  </div> -->
<!-- End Video Gallery Section -->



    <!-- Additional video gallery for generalization examples -->
    <!-- <div class="video-gallery-section" id="generalizationGallerySection">
      <div class="video-gallery-container">
        <div class="video-gallery" id="videoGalleryGeneralization">
          <video class="gallery-video" src="./tipping/Tipping_Single_Disturbance.mp4" autoplay muted playsinline loop></video>
          <video class="gallery-video" src="./cloth/Cloth_Fold.mp4" autoplay muted playsinline loop></video>
        </div>
      </div>
      <div class="gallery-caption-container">
          <div class="gallery-nav-controls">
              <button class="gallery-nav left" id="scrollLeftBtnGeneralization">&lt;</button>
              <button class="gallery-nav right" id="scrollRightBtnGeneralization">&gt;</button>
          </div>
          <p class="figure-caption gallery-caption">
              <b>Generalization:</b> RISE successfully generalizes to new tasks and object configurations.
          </p>
      </div>
    </div> -->





    <!-- =============================== Approach Details ==================================== -->
    <div class="tagline" id="approach-details">The Algorithm.</div>
         <!-- Offline RL Section -->
    <div class="section-subtitle">Offline RL</div>
    <p>TODO</p>
    <!-- <a id="figure-2-img" href="figs/4.png" download="4.png">
      <img src="figs/4-min.png" alt="Lipschitz Continuity">
    </a>
    <p class="figure-caption"> -->

    <!-- Lipschitz Continuity Section -->
    <div class="section-subtitle">Lipschitz Continuity for Robustness</div>
    <p>TODO</p>
    <a id="figure-3-img" href="SpectralGraphic.jpeg" download="SpectralGraphic.jpeg">
      <img src="figs/SpectralGraphic.jpeg" alt="Effect of Spectral Norm on Action Distribution">
    </a>
    <p class="figure-caption">
      <b>Figure 2:</b> Adding a spectral norm penalty to the behavior policy widens the action distribution, improving robustness.
    </p>

     <!-- Data Augmentation Section -->
     <div class="section-subtitle">Data Augmentation</div>
     <p>TODO</p>
    <!-- <a id="figure-3-img" href="figs/3.png" download="3.png">
      <img src="figs/3-min.png" alt="Training Process">
    </a>
    <p class="figure-caption">
      <b>Figure 3:</b> Training process showing how Lipschitz constraints improve policy robustness.
    </p> -->


    <!-- =============================== ACKNOWLEDGEMENTS ==================================== -->
    <div class="tagline" id="acknowledgements">Acknowledgements.</div>
    <div class="section" style="margin-top: -5px;">
      <p>
        The authors would like to acknowledge the members of the Robot Learning Lab and the Washington Embodied Intelligence and Robotics Development Lab for helpful and informative discussions throughout the process of this research.
        The authors would also like to thank Emma Romig for robot hardware help. This research was supported by funding from Toyota Research Institute, under the University 2.0 research program.
      </p>
    </div>

    <!-- =============================== BIBTEX ==================================== -->
    <div class="bibtex-code" id="bibtex">
      <div class="bibtex-title">BibTeX</div>
      <pre><code>Insert bibtex here.
        }</code></pre>
    </div>

  </div> <!-- End of main-content div -->

  <div class="footer">
     Â© UW | Adapted from design by the <span style="font-variant: small-caps;">VideoMimic</span> team. Source code available <a href="https://github.com/videomimic-1/videomimic-1.github.io" target="_blank">here</a>.
  </div>

  <!-- Teaser Video Autoplay with Delay and Loop -->
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const video = document.getElementById('teaser-video');
    const loopDelay = 3000;    // 3 seconds delay before looping
    let loopTimeout;

    if (video) {
      video.muted = true;

      video.addEventListener('ended', function() {
        clearTimeout(loopTimeout); 
        loopTimeout = setTimeout(function() {
          video.currentTime = 0; 
          video.play().catch(function(error) {
            console.log('Delayed loop play prevented for teaser video:', error);
          });
        }, loopDelay);
      });

      video.addEventListener('pause', function() {
        if (!video.ended && video.currentTime > 0) {
           clearTimeout(loopTimeout);
           console.log('Teaser video: Manual pause detected, clearing loop timeout.');
        }
      });

    } else {
      console.error('Video element with ID "teaser-video" not found.');
    }
  });
  </script>

  <!-- JavaScript for Video Gallery Navigation -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const galleries = [
        {
          sectionId: 'ClothGallerySection',
          galleryInnerId: 'videoGalleryCloth',
          scrollLeftBtnId: 'scrollLeftBtnCloth',
          scrollRightBtnId: 'scrollRightBtnCloth'
        },
        {
          sectionId: 'lampshadeGallerySection',
          galleryInnerId: 'videoGalleryLampshade',
          scrollLeftBtnId: 'scrollLeftBtnLampshade',
          scrollRightBtnId: 'scrollRightBtnLampshade'
        },
        {
          sectionId: 'generalizationGallerySection',
          galleryInnerId: 'videoGalleryGeneralization',
          scrollLeftBtnId: 'scrollLeftBtnGeneralization',
          scrollRightBtnId: 'scrollRightBtnGeneralization'
        }
      ];

      galleries.forEach(galleryConfig => {
        const gallerySection = document.getElementById(galleryConfig.sectionId);
        if (!gallerySection) {
          console.error(`Gallery section with ID ${galleryConfig.sectionId} not found.`);
          return;
        }

        const galleryContainer = gallerySection.querySelector('.video-gallery-container');
        const galleryInner = document.getElementById(galleryConfig.galleryInnerId);
        const scrollLeftBtn = document.getElementById(galleryConfig.scrollLeftBtnId);
        const scrollRightBtn = document.getElementById(galleryConfig.scrollRightBtnId);

        if (galleryContainer && galleryInner && scrollLeftBtn && scrollRightBtn) {
          const scrollAmount = (galleryInner.firstElementChild?.offsetWidth || 300) + 15;

          scrollLeftBtn.addEventListener('click', () => {
            galleryContainer.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
          });

          scrollRightBtn.addEventListener('click', () => {
            galleryContainer.scrollBy({ left: scrollAmount, behavior: 'smooth' });
          });

        } else {
          console.error(`Gallery elements not found for navigation setup in section ${galleryConfig.sectionId}.`);
          if (!galleryContainer) console.error('Missing element: .video-gallery-container in section ' + galleryConfig.sectionId);
          if (!galleryInner) console.error(`Missing element with ID ${galleryConfig.galleryInnerId}`);
          if (!scrollLeftBtn) console.error(`Missing element with ID ${galleryConfig.scrollLeftBtnId}`);
          if (!scrollRightBtn) console.error(`Missing element with ID ${galleryConfig.scrollRightBtnId}`);
        }
      });
    });
  </script>

  <!-- JavaScript to prevent default click on specific image links -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const imageLinkIds = ['figure-1-img', 'figure-2-img', 'figure-3-img'];
      imageLinkIds.forEach(id => {
        const link = document.getElementById(id);
        if (link) {
          link.addEventListener('click', function(e) {
            e.preventDefault();
          });
        }
      });
    });
  </script>

</body>
</html>
